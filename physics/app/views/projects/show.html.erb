<body class="body-main">
<!--Navbar-->
<%= render "layouts/header" %>
<div class="container-fluid">
<p id="notice"><%= notice %></p>

<p>
  <strong>Name:</strong>
  <%= @project.name %>
</p>

<p>
  <strong>Description:</strong>
  <%= @project.description %>
</p>

<p>
  <strong>Owner:</strong>
  <%= @project.owner_id %>
</p>

<%= link_to 'Edit', edit_project_path(@project) %> |
<%= link_to 'List of Projects', projects_path %>
<% provide(:title, "Editor") %>

  <div class="col-md-4">
    <!--Editor-->
    <div class="col-md-12">
      <textarea class="form-control editor" id="editor-input"></textarea>
    </div>


<script>

	var myDataRef = new Firebase('https://brilliant-fire-2071.firebaseio.com/Projects/'.concat("project".concat(String(<%= @project.id %>))));

	$('#editor-input').on('input', function() {
	  	var text = $('#editor-input').val();
		myDataRef.push().set({text: text});
	});

	myDataRef.on('child_added', function(snapshot) {
	var message = snapshot.val();
	$('#editor-input').val(message.text).change();
	});
</script>
    <!--Chatbox-->
    <div class="col-md-12">
      <!--Chatlog-->

      <div id='messagesDiv'>
    <input type='text' id='messageInput' placeholder='Message'>
    <script>
      var myDataRef = new Firebase('https://brilliant-fire-2071.firebaseio.com/Projects/'.concat("chat".concat(String(<%= @project.id %>))));
      $('#messageInput').keypress(function (e) {
        if (e.keyCode == 13) {
          var name = <%= current_user.id %>;
          var text = $('#messageInput').val();
          myDataRef.push({name: name, text: text});
          $('#messageInput').val('');
        }
      });
      myDataRef.on('child_added', function(snapshot) {
        var message = snapshot.val();
        displayChatMessage(message.name, message.text);
      });
      function displayChatMessage(name, text) {
        $('<div/>').text(text).prepend($('<em/>').text(name+': ')).appendTo($('#messagesDiv'));
        $('#messagesDiv')[0].scrollTop = $('#messagesDiv')[0].scrollHeight;
      };
    </script>
      </div>
    </div>
    <div class="col-md-12">
      <!--SMS-->
      <div>
      </div>
    </div>
  </div>
  <!--Empty Coloumn-->
  <div class="col-md-1">
  </div>
  <!--Editor Render-->
<script>
	
</script>
  <div class="col-md-6 editor-render">

    <div class="sheet-music" id="sheet-music"></div>
 
    <div id="warnings"></div>

  </div>

</div>
</body>
</html>